---
ID: 553
post_title: 'Comment estimer les paramètres d&#039;une loi de probabilité avec R ?'
author: Melen
post_excerpt: ""
layout: post
permalink: >
  https://abcdr.thinkr.fr/comment-estimer-les-parametres-dune-loi-de-probabilite-avec-r/
published: true
post_date: 2011-11-08 15:13:04
tags: [ ]
categories:
  - bayésien
  - inférence
---
On cherche souvent à modéliser un échantillon par une loi de probabilité. <br />A partir d'un jeu de données, comment peut-on trouver les paramètres d'une loi préalablement fixée?<br /><br />Plusieurs méthodes peuvent être utilisées.<br /><br />On prend l'exemple ici du délai entre l'infection d'un individu et la détection de cet individu comme malade.<br />On modélise ici ce délai (en jours) par une loi de Weibull (on peut aussi essayer les lois gamma et lognormale par exemple)<br /><br />La méthode la plus simple est d'utiliser la fonction fitdistr du package MASS.<br />Cette fonction permet d'ajuster de nombreuses lois par maximum de vraisemblance. Regardons ce que ça donne pour une loi Weibull.<br /><br /> <pre><code><br /><br />#on charge le package Mass<br /> library(MASS) <br /><br /># on appelle z le délai entre infection et détection, z est un vecteur contenant les données<br /><br />z&lt;-c(14,14,14,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,23)<br /><br />#toujours visualiser ses données, ici un histogramme est le plus adapté!<br /><br /> hist(z) <br /><br /># on utilise la fonction fitdistr pour une loi Weibull, regarder ?fitdistr<br /><br /> paraw &lt;- fitdistr(z,densfun="weibull") <br /> logLik(paraw)  # on peut avoir le loglikelihood<br /><br /># on visualise les résultats sur un graphique : histogramme+ loi <br /><br /> hist(z,freq=FALSE) # penser à frep=FALSE!!<br /> lines(dweibull(0:max(z),shape=paraw$estimate[1],scale=paraw$estimate[2]),type='l',col='green',lwd=2)<br /><br />#on simule une loi de weibull avec dweibull en utilisant les paramètres estimés<br />#regarder ?dweibull, <br />#on peut simuler de nombreuses lois sur R par exemple, gamma avec dgamma(), normale avec dnorm()...<br /><br /></code></pre> <br /><br />On peut également écrire directement la vraisemblance et trouver le maximum de vraisemblance.<br />Dans cet exemple on utilise le package bbmle<br /><br /> <pre><code><br /><br />library(bbmle) <br /><br />#on écrit la vraisemblance pour une weibull (loglikelihood ici)<br /><br /> weiblikfun&lt;-function(shape,scale){<br />    -sum((dweibull(z,shape=shape,scale=scale,log=TRUE)))}<br /><br /># on cherche à minimiser le loglikelihood avec mle2, regarder ?mle2!!!!<br /><br /> w&lt;-mle2(weiblikfun,start=list(shape= 10,scale=20)) <br /><br />w #donne les paramètres estimés<br />confint(w) #donne des intervalles de confiance<br /><br /> </code></pre>  <br /><br />Enfin on peut estimer les paramètres dans un cadre bayésien en lançant des MCMC.<br />Le plus simple est d'utiliser le Gibbs sampler via Winbugs ou OpenBugs.<br />On peut lancer ces derniers via R et le package R2WinBUGS par exemple.<br />Enfin on peut analyser le resultat des MCMC via le package coda.<br /><br />  <pre><code> <br /><br /> library(R2WinBUGS)<br />library(coda) <br /><br />#on met en forme les données pour Winbugs (en liste)<br /> data&lt;-list(T=z,N=length(z))<br /><br /> </code></pre>  <br /><br />Il faut écrire un code Winbugs dans un fichier txt et le mettre dans le répertoire courant.<br />Voilà ce que ça peut donner pour une weibull (ceci correspond à modelweibull.txt placé dans le répertoire courant):<br /><br /> <pre><code><br /><br /> #model<br /><br />model{<br /><br />#priors<br /><br />v~dgamma(0.01,0.01)<br /><br />#v~dlnorm(0,0.0001)<br />lambda~dbeta(1,1)<br /><br />s&lt;-pow((1/lambda),(1/v))<br /><br />#likelihood<br />for(i in 1:N) {<br /><br />T[i]~dweib(v,lambda)<br /><br />}<br /><br />} <br /> </code></pre>  <br /><br />Enfin on lance le tout et on regarde le comportement des MCMC!<br />  <pre><code> <br /><br /> rweibull&lt;-bugs(data,inits=NULL,parameters.to.save=c("v","s"),<br />        model.file="modelweibull.txt",n.chains=4,n.iter=100000,codaPkg=TRUE)<br /><br />rweibull.coda&lt;-read.bugs(rweibull)<br />summary(rweibull.coda)<br />xyplot(rweibull.coda)<br />acfplot(rweibull.coda)<br />densityplot(rweibull.coda,col="blue")<br />rejectionRate(rweibull.coda)<br /><br /> </code></pre>  <br /><br />Ce long exemple peut être utilisé pour d'autres lois. Je vous conseille vivement de bien regarder les expressions analytiques utilisées pour chaque fonction. Par exemple la loi de Weibull peut être écrite de différentes façons. Vous aurez peut être remarqué que les fonctions utilisées dans R et winbugs n'utilisent pas la même expression: ATTENTION!!<br /><br />Enfin, il est souvent possible de modéliser des données par différentes lois, il s'agit ensuite de trouver celle qui correspond le mieux....